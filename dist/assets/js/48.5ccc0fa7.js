(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{400:function(t,e,n){"use strict";n.r(e);var s=n(42),a=Object(s.a)({},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"vue初始化流程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vue初始化流程"}},[t._v("#")]),t._v(" vue初始化流程")]),t._v(" "),n("p",[t._v("入口"),n("strong",[t._v("src/platforms/web/entry-runtime-with-compiler.js")])]),t._v(" "),n("ul",[n("li",[t._v("扩展$mount方法:处理template或el选项，编译成render函数，将vdom转换成dom并执行挂载。模板优先级：render>template>el。")])]),t._v(" "),n("p",[t._v("查找Vue文件进入"),n("strong",[t._v("src/ platforms/web/runtime/index.js")]),t._v("文件")]),t._v(" "),n("ul",[n("li",[t._v("1.安装web平台补丁函数patch，用于初始化和更新")]),t._v(" "),n("li",[t._v("2.实现了$mount")])]),t._v(" "),n("p",[t._v("查找Vue文件进入"),n("strong",[t._v("src/core/index.js")])]),t._v(" "),n("ol",[n("li",[t._v("初始化全局API，entend、nextTick、defineReactive、set、del")])]),t._v(" "),n("p",[t._v("重要："),n("strong",[t._v("src/core/instance/index.js")])]),t._v(" "),n("p",[t._v("Vue构造函数定义")]),t._v(" "),n("ol",[n("li",[t._v("初始化this._init(来自initMixin)")]),t._v(" "),n("li",[t._v("定义实例属性和方法")])]),t._v(" "),n("p",[t._v("进入init方法"),n("strong",[t._v("src/core/instance/init.js")])]),t._v(" "),n("ol",[n("li",[t._v("合并选项")]),t._v(" "),n("li",[t._v("initLifecycle(vm)  // $parent、$root、$children、$refs")]),t._v(" "),n("li",[t._v("initEvents(vm)  // 处理父组件传递的事件和回调")]),t._v(" "),n("li",[t._v("initRender(vm)  // $slots、$scopedSlots、_c、$createElement")]),t._v(" "),n("li",[t._v("callHook(vm, 'beforeCreate')")]),t._v(" "),n("li",[t._v("initInjections(vm) // 注入祖辈传入数据")]),t._v(" "),n("li",[t._v("initState(vm) // 初始化props，methods，data，computed，watch")]),t._v(" "),n("li",[t._v("initProvide(vm) // 向后代提供数据")]),t._v(" "),n("li",[n("strong",[t._v("$mount")]),t._v("  // 执行挂载，获取vdom并转换为dom")])]),t._v(" "),n("p",[t._v("整体流程捋一捋")]),t._v(" "),n("p",[t._v("new Vue() => _init() => $mount() => mountComponent() => updateComponent()/new Watcher() => render() => _update()=>"),n("strong",[t._v("patch")])]),t._v(" "),n("h4",{attrs:{id:"数据响应式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#数据响应式"}},[t._v("#")]),t._v(" 数据响应式")]),t._v(" "),n("p",[n("strong",[t._v("initState (vm: Component) src\\core\\instance\\state.js")])]),t._v(" "),n("p",[t._v("初始化数据，包括props、methods、data、computed和watch")]),t._v(" "),n("p",[n("strong",[t._v("initData")]),t._v("核心代码是将"),n("strong",[t._v("data")]),t._v("数据响应化")]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[t._v(" \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("initData")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("vm"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Component")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 执行数据响应化")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("observe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* asRootData */")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])}),[],!1,null,null,null);e.default=a.exports}}]);